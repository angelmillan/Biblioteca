/* Script proyecto de recuperación.*/
/* Angl Millan Miralles 1ºDAM */

PRAGMA foreign_keys = ON;

DROP TABLE IF EXIST LIBROS;

CREATE TABLE LIBROS
(
ISBN 		TEXT PRIMARY KEY,
TITULO		TEXT NOT NULL,
AUTOR		TEXT NOT NULL,
EDITORIAL 	TEXT NOT NULL,
EDICION		INTEGER NOT NULL
);



DROP TABLE IF EXIST EJEMPLARES;

CREATE TABLE EJEMPLARES
(
ID_EJEMPLAR     INTEGER ROWID,
ISBN            TEXT,

CONSTRAINT FK_EJEMPLAR FOREIGN KEY (ISBN)
           REFERENCES LIBROS,
CONSTRAINT PK_EJEMPLAR PRIMARY KEY (ID_EJEMPLAR, ISBN)
);



DROP TABLE IF EXIST USUARIOS;

CREATE TABLE USUARIOS
(
DNI             REAL PRIMARY KEY,
NOMBRE          TEXT NOT NULL,
APELLIDOS       TEXT NOT NULL,
DIRECCION		TEXT
);



DROP TABLE IF EXIST PRESTAMOS;

CREATE TABLE PRESTAMOS
(
FECHA           TEXT,
DNI             TEXT,
CLAVE_EJEMPLAR  TEXT,

CONSTRAINT FK_PRESTAMOS_SOCIOS FOREIGN KEY (DNI)
           REFERENCES USUARIOS;

CONSTRAINT FK_PRESTAMOS_EJEMPLARES FOREIGN KEY (CLAVE_EJEMPLAR)
           REFERENCES EJEMPLARES,

CONSTRAINT PK_PRESTAMOS PRIMARY KEY (DNI, CLAVE_EJEMPLAR, FECHA)
);







